sqlite3 "/Volumes/PACS/Backup/.tmp/dbcopy/Database_copy.sql" \
"SELECT COUNT(DISTINCT s.ZSTUDY) FROM ZSERIES s WHERE TRIM(UPPER(COALESCE(s.ZMODALITY,''))) IN ('CT','MR');"

sqlite3 "/Volumes/PACS/Backup/.tmp/dbcopy/Database_copy.sql" \
"SELECT COUNT(*) FROM ZSTUDY st
 WHERE INSTR(UPPER(COALESCE(st.ZMODALITY,'')), 'CT')>0
    OR INSTR(UPPER(COALESCE(st.ZMODALITY,'')), 'MR')>0
    OR INSTR(UPPER(COALESCE(st.ZMODALITIESINSTUDY,'')), 'CT')>0
    OR INSTR(UPPER(COALESCE(st.ZMODALITIESINSTUDY,'')), 'MR')>0;"

sqlite3 "/Volumes/PACS/Backup/.tmp/dbcopy/Database_copy.sql" "
WITH Cand AS (
  SELECT st.Z_PK
  FROM ZSTUDY st
  WHERE INSTR(UPPER(COALESCE(st.ZMODALITY,'')), 'CT')>0
     OR INSTR(UPPER(COALESCE(st.ZMODALITY,'')), 'MR')>0
     OR INSTR(UPPER(COALESCE(st.ZMODALITIESINSTUDY,'')), 'CT')>0
     OR INSTR(UPPER(COALESCE(st.ZMODALITIESINSTUDY,'')), 'MR')>0
  UNION
  SELECT DISTINCT s.ZSTUDY
  FROM ZSERIES s
  WHERE TRIM(UPPER(COALESCE(s.ZMODALITY,''))) IN ('CT','MR')
)
SELECT COUNT(*) FROM Cand;
"